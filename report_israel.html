<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>投资报告 - Innonation</title>

    <!-- Favicon -->
    <link rel="shortcut icon" href="https://innonation.oss-cn-beijing.aliyuncs.com/shortcut/in.jpg">

    <!-- 引入现代CSS框架 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome 6 -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- AOS 动画库 -->
    <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">

    <!-- 使用通用样式 -->
    <link rel="stylesheet" href="common/css/variables.css">
    <link rel="stylesheet" href="common/css/components.css">
	<link rel="stylesheet" href="common/css/inno-global-menu.css">
    <link rel="stylesheet" href="common/css/user-profile.css">
	
    <link rel="stylesheet" href="css/report_israel.css">

    <style>
        /* 升级模态框动画 */
        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(25, 111, 166, 0.7);
            }
            50% {
                transform: scale(1.02);
                box-shadow: 0 0 20px 10px rgba(25, 111, 166, 0);
            }
        }

        /* 模态框内容动画 */
        .modal-content {
            animation: modalFadeIn 0.3s ease-out;
        }

        /* 权益列表项动画 */
        .benefit-item {
            opacity: 0;
            animation: slideInLeft 0.5s ease-out forwards;
        }

        .benefit-item:nth-child(1) { animation-delay: 0.1s; }
        .benefit-item:nth-child(2) { animation-delay: 0.2s; }
        .benefit-item:nth-child(3) { animation-delay: 0.3s; }
        .benefit-item:nth-child(4) { animation-delay: 0.4s; }
        .benefit-item:nth-child(5) { animation-delay: 0.5s; }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* 渐变按钮悬停效果 */
        .modal-footer .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4) !important;
            transition: all 0.3s ease;
        }

        /* 图标旋转动画 */
        .fa-crown {
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }
    </style>

    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <!-- Axios -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  </head>
<body>
    <div id="app" v-cloak>
        <!-- 全局菜单挂载点（公共组件渲染） -->
        <div id="inno-global-menu"></div>

        <!-- Loading State -->
        <div v-if="loading" class="position-fixed top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex align-items-center justify-content-center" style="z-index: 9999;">
            <div class="text-center">
                <div class="loading-logo" style="font-weight: 700; font-size: 2rem; color: #104991; margin-bottom: 1.5rem;">INNONATION <b>AI</b></div>
                <div class="spinner-border text-primary mb-3" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
            </div>
        </div>

        <!-- 导航栏 -->
        <nav class="navbar navbar-expand-lg fixed-top">
            <div class="container">
                <a class="navbar-brand" href="#">
                    INNONATION <b>AI</b>
                </a>
                <div class="ms-auto d-flex align-items-center gap-3">
                    <div class="language-switch" @click="toggleLang">
                        <i class="fa-solid fa-globe"></i>
                        <span class="lang-text">{{ currentLang === 'zh' ? 'EN' : '中文' }}</span>
                    </div>
                </div>
            </div>
        </nav>

        <!-- 主要内容区域 -->
        <div class="container page-container with-fixed-header">
            <!-- 报告标题区域 -->
            <div class="report-hero" data-aos="fade-up">
                <div class="container">
                    <h1>{{ t('new-report-title1') }}</h1>
                    <p>{{ t('new-report-desc1') }}</p>
                </div>
            </div>

            <!-- 主要内容 -->
            <div class="report-layout">
                <!-- 左侧主要内容 -->
                <div class="report-main">
                    <!-- 月度报告列表 -->
                    <div class="card" data-aos="fade-up">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-file-lines"></i>
                                {{ t('monthlyReports') }}
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead class="table-light">
                                        <tr>
                                            <th>{{ t('date') }}</th>
                                            <th>{{ t('reportName') }}</th>
                                            <th>{{ t('actions') }}</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="report in displayedReports" :key="report.id">
                                            <td>{{ report.date }}</td>
                                            <td>
                                                <a href="#" @click.prevent="openReport(report)" class="text-primary text-decoration-none">
                                                    {{ report.name }}
                                                </a>
                                            </td>
                                            <td>
                                                <button class="btn btn-primary btn-sm" @click="openReport(report)">
                                                    <i class="fas fa-external-link-alt"></i> {{ t('viewReport') }}
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <!-- Load More Button -->
                            <div v-if="hasMoreReports" class="text-center mt-3">
                                <button class="btn btn-outline-primary" @click="loadMoreReports">
                                    <i class="fas fa-plus"></i> {{ currentLang === 'zh' ? '加载更多' : 'Load More' }}
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- 年度报告 - 中国投资以色列 -->
                    <div class="card" data-aos="fade-up" data-aos-delay="100">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-chart-line"></i>
                                {{ t('chinaInvestReportTitle') }}
                            </h5>
                            <p class="text-muted small mb-0 mt-2">{{ t('chinaInvestReportSubtitle') }}</p>
                        </div>
                        <div class="card-body">
                            <p class="text-muted mb-4">{{ t('chinaInvestReportDesc') }}</p>

                            <!-- 核心发现预览 -->
                            <div class="mb-4">
                                <h6 class="fw-bold mb-3">
                                    <i class="fas fa-lightbulb text-warning me-2"></i>{{ t('coreFinding') }}
                                </h6>
                                <div class="row g-3">
                                    <!-- 核心趋势 -->
                                    <div class="col-md-4">
                                        <div class="p-3 bg-light rounded border-start border-primary border-4 d-flex flex-column" style="min-height: 140px;">
                                            <div class="text-muted small mb-2">{{ t('coreTrend') }}</div>
                                            <div class="fs-4 fw-bold text-primary mb-2">{{ t('precisionIrrigation') }}</div>
                                            <div class="text-muted small mt-auto">{{ t('precisionIrrigationDesc') }}</div>
                                        </div>
                                    </div>
                                    <!-- VC/战略投资 -->
                                    <div class="col-md-4">
                                        <div class="p-3 bg-light rounded border-start border-success border-4 d-flex flex-column" style="min-height: 140px;">
                                            <div class="text-muted small mb-2">{{ t('vcStrategicInvest') }}</div>
                                            <div class="fs-4 fw-bold text-success mb-2">{{ t('vcCasesCount') }}</div>
                                            <div class="text-muted small mt-auto">{{ t('vcCasesDesc') }}</div>
                                        </div>
                                    </div>
                                    <!-- 重大并购 -->
                                    <div class="col-md-4">
                                        <div class="p-3 bg-light rounded border-start border-info border-4 d-flex flex-column" style="min-height: 140px;">
                                            <div class="text-muted small mb-2">{{ t('majorMA') }}</div>
                                            <div class="fs-4 fw-bold text-info mb-2">{{ t('maCasesCount') }}</div>
                                            <div class="text-muted small mt-auto">{{ t('maCasesDesc') }}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 报告内容预览（模糊效果） -->
                            <div class="mb-4 position-relative" style="overflow: hidden; border-radius: 0.5rem;">
                                <div class="bg-light p-4 border" style="filter: blur(2px); pointer-events: none; user-select: none;">
                                    <h6 class="fw-bold text-secondary mb-3">
                                        <i class="fas fa-briefcase me-2"></i>{{ currentLang === 'zh' ? '重大并购案例' : 'Major M&A Case' }}
                                    </h6>
                                    <div class="row align-items-center">
                                        <div class="col-md-4 text-center">
                                            <div class="small text-muted">{{ currentLang === 'zh' ? '收购方' : 'Acquirer' }}</div>
                                            <div class="h5 fw-bold text-primary mt-2">{{ currentLang === 'zh' ? '联想集团' : 'Lenovo Group' }}</div>
                                            <div class="small text-muted">{{ currentLang === 'zh' ? '中国' : 'China' }}</div>
                                        </div>
                                        <div class="col-md-4 text-center">
                                            <i class="fas fa-arrow-right fa-2x text-primary"></i>
                                        </div>
                                        <div class="col-md-4 text-center">
                                            <div class="small text-muted">{{ currentLang === 'zh' ? '目标公司' : 'Target' }}</div>
                                            <div class="h5 fw-bold text-dark mt-2">Infinidat</div>
                                            <div class="small text-muted">{{ currentLang === 'zh' ? '以色列' : 'Israel' }}</div>
                                        </div>
                                    </div>
                                    <div class="mt-3">
                                        <p class="small text-muted mb-2">
                                            <strong>{{ currentLang === 'zh' ? '关键分析：' : 'Key Analysis:' }}</strong>
                                            {{ currentLang === 'zh' ? '报告期内唯一重大并购案。此项交易由清晰的产品组合逻辑驱动...' : 'The only major M&A case during the reporting period. This transaction was driven by clear product portfolio logic...' }}
                                        </p>
                                    </div>
                                    <hr class="my-3">
                                    <h6 class="fw-bold text-secondary mb-3">
                                        <i class="fas fa-chart-line me-2"></i>{{ currentLang === 'zh' ? 'VC/战略投资案例' : 'VC/Strategic Investment Cases' }}
                                    </h6>
                                    <div class="row g-2">
                                        <div class="col-md-6">
                                            <div class="bg-white p-3 rounded border-top border-danger border-3">
                                                <div class="fw-bold text-danger">MitrAssist</div>
                                                <div class="small text-muted">{{ currentLang === 'zh' ? '医疗器械 | 1亿美元 (C轮)' : 'MedTech | $100M (Series C)' }}</div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="bg-white p-3 rounded border-top border-success border-3">
                                                <div class="fw-bold text-success">ONE ZERO Digital Bank</div>
                                                <div class="small text-muted">{{ currentLang === 'zh' ? '金融科技 | 6200万美元 (B轮)' : 'FinTech | $62M (Series B)' }}</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- 渐变遮罩 -->
                                <div class="position-absolute bottom-0 start-0 w-100" style="height: 120px; background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0.95), rgba(255,255,255,1)); pointer-events: none;"></div>
                            </div>

                            <div class="d-grid gap-2 d-md-block" style="padding-top: 1rem;">
                                <button class="btn btn-primary" @click="viewChinaInvestReport">
                                    <i class="fas fa-file-alt"></i> {{ t('viewDetailedReport') }}
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- 公司分析报告 -->
                    <!-- <div class="card" data-aos="fade-up" data-aos-delay="200">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-building"></i>
                                {{ t('new-report-title2') }}
                            </h5>
                        </div>
                        <div class="card-body">
                            <p class="text-muted">{{ t('new-report-desc4') }}</p>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <div class="report-feature">
                                        <i class="fas fa-search"></i>
                                        <h4>{{ t('companySearch') }}</h4>
                                        <p>{{ t('companySearchDesc') }}</p>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="report-feature">
                                        <i class="fas fa-chart-pie"></i>
                                        <h4>{{ t('marketAnalysis') }}</h4>
                                        <p>{{ t('marketAnalysisDesc') }}</p>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="report-feature">
                                        <i class="fas fa-dollar-sign"></i>
                                        <h4>{{ t('financialForecast') }}</h4>
                                        <p>{{ t('financialForecastDesc') }}</p>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="report-feature">
                                        <i class="fas fa-users"></i>
                                        <h4>{{ t('teamAnalysis') }}</h4>
                                        <p>{{ t('teamAnalysisDesc') }}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> -->
                </div>

                <!-- 右侧边栏 -->
                <div class="report-sidebar">
                    <!-- 报告定制服务 -->
                    <div class="card" data-aos="fade-up" data-aos-delay="100">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-cog"></i>
                                {{ t('customReportService') }}
                            </h5>
                        </div>
                        <div class="card-body">
                            <p class="text-muted small">{{ t('customReportDesc') }}</p>
                            <ul class="list-unstyled">
                                <li class="mb-2">
                                    <i class="fas fa-check text-success me-2"></i>
                                    {{ t('reportFeature1') }}
                                </li>
                                <li class="mb-2">
                                    <i class="fas fa-check text-success me-2"></i>
                                    {{ t('reportFeature2') }}
                                </li>
                                <li class="mb-2">
                                    <i class="fas fa-check text-success me-2"></i>
                                    {{ t('reportFeature3') }}
                                </li>
                                <li class="mb-2">
                                    <i class="fas fa-check text-success me-2"></i>
                                    {{ t('reportFeature4') }}
                                </li>
                            </ul>
                            <button class="btn btn-primary w-100" @click="contactService">
                                <i class="fas fa-phone"></i> {{ t('contactService') }}
                            </button>
                        </div>
                    </div>

                    <!-- 报告样例 -->
                    <div class="card" data-aos="fade-up" data-aos-delay="200">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-file-alt"></i>
                                {{ t('reportSamples') }}
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="d-grid gap-2">
                                <button class="btn btn-outline-primary btn-sm" @click="viewSample('in-depth')">
                                    {{ t('new-report-name1') }}
                                </button>
                                <button class="btn btn-outline-primary btn-sm" @click="viewSample('standard')">
                                    {{ t('new-report-name2') }}
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- 联系方式 -->
                    <div class="card" data-aos="fade-up" data-aos-delay="300">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-qrcode"></i>
                                {{ t('contactUs') }}
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="qr-section">
                                <div class="qr-code">
                                    <img src="../dashboard/dist/img/report/qrcode.png" alt="WeChat QR" style="width: 100%; height: 100%; object-fit: contain;">
                                </div>
                                <h5>{{ t('customerService') }}</h5>
                                <p>{{ t('scanQRDesc') }}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 报告模态框 -->
        <div v-if="showReportModal" class="modal fade show d-block" style="background-color: rgba(0,0,0,0.5);" tabindex="-1">
            <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{{ selectedReport?.name || '' }}</h5>
                        <button type="button" class="btn-close" @click="showReportModal = false"></button>
                    </div>
                    <div class="modal-body">
                        <div v-if="reportLoading" class="text-center py-5">
                            <div class="spinner-border text-primary mb-3" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                            <p class="text-muted fw-medium">{{ t('loadingReport') }}</p>
                        </div>
                        <div v-else-if="reportContent">
                            <div class="report-content" v-html="reportContent"></div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" @click="showReportModal = false">{{ t('close') }}</button>
                        <button type="button" class="btn btn-primary" @click="downloadCurrentReport">
                            <i class="fas fa-download"></i> {{ t('download') }}
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 升级提示模态框 - 现代化设计 -->
        <div v-if="showUpgradeModal" class="modal fade show d-block" style="background-color: rgba(0,0,0,0.6); backdrop-filter: blur(4px);" tabindex="-1" @click.self="showUpgradeModal = false">
            <div class="modal-dialog modal-dialog-centered" style="max-width: 540px; margin: 1.75rem auto;">
                <div class="modal-content border-0 shadow-lg" style="border-radius: 1rem; overflow: hidden;">
                    <!-- 渐变头部 - 压缩高度 -->
                    <div class="modal-header border-0 text-white position-relative" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 1.75rem 1.5rem 1.5rem 1.5rem;">
                        <button type="button" class="btn-close btn-close-white position-absolute" @click="showUpgradeModal = false" style="top: 1.25rem; right: 1.25rem; opacity: 0.9;"></button>
                        <div class="w-100 text-center">
                            <div class="mb-2">
                                <i class="fas fa-crown fa-2x" style="opacity: 0.95;"></i>
                            </div>
                            <h6 class="modal-title fw-bold mb-0" style="font-size: 1.1rem;">{{ t('upgradeTitle') }}</h6>
                        </div>
                    </div>

                    <div class="modal-body" style="padding: 1.5rem; overflow-y: visible;">
                        <!-- 当前账户状态 -->
                        <div class="alert alert-light border d-flex align-items-center mb-3" style="border-radius: 0.75rem; padding: 0.75rem;">
                            <i class="fas fa-user-circle fa-lg text-muted me-2"></i>
                            <div>
                                <div class="small text-muted" style="font-size: 0.8rem;">{{ t('currentPlan') }}</div>
                                <div class="fw-bold" style="font-size: 0.95rem;">{{ currentUserPlan }}</div>
                            </div>
                        </div>

                        <p class="text-muted mb-3" style="font-size: 0.875rem; line-height: 1.5;">{{ t('upgradeDescription') }}</p>

                        <!-- 权益列表 - 紧凑版 -->
                        <div class="benefits-list">
                            <div class="benefit-item mb-2" v-for="i in 5" :key="i">
                                <div class="d-flex align-items-center">
                                    <div class="benefit-icon me-2" style="flex-shrink: 0;">
                                        <i class="fas fa-check-circle text-success" style="font-size: 1.1rem;"></i>
                                    </div>
                                    <div class="flex-grow-1">
                                        <p class="mb-0" style="line-height: 1.5; font-size: 0.85rem;">{{ t('upgradeBenefit' + i) }}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="modal-footer border-0 bg-light d-flex justify-content-between" style="padding: 1rem 1.5rem;">
                        <button type="button" class="btn btn-light" @click="showUpgradeModal = false" style="flex: 0 0 auto; padding: 0.5rem 1.5rem;">
                            {{ t('close') }}
                        </button>
                        <button type="button" class="btn btn-primary" @click="contactForUpgrade" style="flex: 0 0 auto; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3); padding: 0.5rem 1.25rem; white-space: nowrap;">
                            <i class="fas fa-rocket me-1" style="font-size: 0.9rem;"></i>{{ t('contactUpgrade') }}
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- AOS Animation -->
    <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>

    <script src="common/js/common-utils.js"></script>
    <script src="common/js/api-client.js"></script>

    <!-- 全局菜单组件 -->
    <script src="common/js/inno-global-menu.js"></script>

    <!-- 用户资料组件 -->
    <script src="common/js/user-profile.js"></script>

    <!-- 认证检查脚本 - JWT通用验证 -->
    <script src="common/js/auth-check.js"></script>

    <script>

// Initialize AOS animations
AOS.init({
	duration: 800,
	easing: 'ease-in-out',
	once: true
});

// Vue App
const DEFAULT_LANG = (localStorage.getItem('inno_lang') || 'zh');
const FALLBACK_I18N = {
	zh: {
		loadingReportInfo: '正在加载报告信息...',
		monthlyReports: '月度报告',
		reportName: '报告名称',
		actions: '操作',
		download: '下载',
		generateReport: '生成报告',
		viewSample: '查看样例',
		companySearch: '公司搜索',
		companySearchDesc: '智能搜索目标公司信息',
		marketAnalysis: '市场分析',
		marketAnalysisDesc: '深入分析市场趋势和机会',
		financialForecast: '财务预测',
		financialForecastDesc: '专业的财务数据分析和预测',
		teamAnalysis: '团队分析',
		teamAnalysisDesc: '核心团队成员背景和能力分析',
		customReportService: '报告定制服务',
		customReportDesc: '根据您的需求定制专属报告',
		reportFeature1: '深度行业分析',
		reportFeature2: '竞品对比分析',
		reportFeature3: '投资机会评估',
		reportFeature4: '市场进入策略',
		reportSamples: '报告样例',
		contactService: '联系客服',
		customerService: '客服微信',
		scanQRDesc: '扫码添加客服微信',
		loadingReport: '正在加载报告...',
		close: '关闭',
		date: '日期',
		contactUs: '联系我们'
	},
	en: {
		loadingReportInfo: 'Loading report info...',
		monthlyReports: 'Monthly Reports',
		reportName: 'Report Name',
		actions: 'Actions',
		download: 'Download',
		generateReport: 'Generate Report',
		viewSample: 'View Sample',
		companySearch: 'Company Search',
		companySearchDesc: 'Intelligent search for target company information',
		marketAnalysis: 'Market Analysis',
		marketAnalysisDesc: 'In-depth analysis of market trends and opportunities',
		financialForecast: 'Financial Forecast',
		financialForecastDesc: 'Professional financial data analysis and forecasting',
		teamAnalysis: 'Team Analysis',
		teamAnalysisDesc: 'Analysis of core team members\' background and capabilities',
		customReportService: 'Custom Report Service',
		customReportDesc: 'Customized reports based on your needs',
		reportFeature1: 'Deep Industry Analysis',
		reportFeature2: 'Competitive Analysis',
		reportFeature3: 'Investment Opportunity Assessment',
		reportFeature4: 'Market Entry Strategy',
		reportSamples: 'Report Samples',
		contactService: 'Contact Service',
		customerService: 'Customer Service WeChat',
		scanQRDesc: 'Scan to add customer service WeChat',
		loadingReport: 'Loading report...',
		close: 'Close',
		date: 'Date',
		contactUs: 'Contact Us'
	}
};
const { createApp } = Vue;

const app = createApp({
	data() {
		return {
			// i18n
			currentLang: DEFAULT_LANG,
			translations: FALLBACK_I18N[DEFAULT_LANG] || {},
			// Report data
			monthlyReports: [],
			annualReports: [],
			// UI state
			loading: true,
			showReportModal: false,
			reportLoading: false,
			reportContent: null,
			selectedReport: null,
			// Load More functionality
			displayCount: 3, // 默认显示10条记录
			// Upgrade modal
			showUpgradeModal: false,
			userInfo: null,
			currentUserPlan: ''
		}
	},
	async mounted() {
		// 立即滚动到顶部，防止浏览器自动恢复滚动位置
		if ('scrollRestoration' in history) {
			history.scrollRestoration = 'manual';
		}
		window.scrollTo(0, 0);
		document.documentElement.scrollTop = 0;
		document.body.scrollTop = 0;

		await this.loadI18n();
		await this.loadUserInfo();
		await this.initData();

		// 最终确保页面在顶部
		this.$nextTick(() => {
			setTimeout(() => {
				window.scrollTo(0, 0);
				document.documentElement.scrollTop = 0;
				document.body.scrollTop = 0;
			}, 100);
		});
	},
	computed: {
		displayedReports() {
			return this.monthlyReports.slice(0, this.displayCount);
		},
		hasMoreReports() {
			return this.monthlyReports.length > this.displayCount;
		}
	},
	methods: {
		// i18n helpers
		async loadI18n() {
			try {
				// Load page-specific translations
				const res = await axios.get(`common/i18n/report_israel.${this.currentLang}.json`);
				const pageTranslations = res.data;

				this.translations = {
					...(FALLBACK_I18N[this.currentLang] || {}),
					...pageTranslations
				};
			} catch (e) {
				console.warn('Failed to load i18n files, using fallback:', e);
				this.translations = FALLBACK_I18N[this.currentLang] || {};
			}
		},
		t(key) {
			return this.translations[key] || key;
		},
		async toggleLang() {
			this.currentLang = this.currentLang === 'zh' ? 'en' : 'zh';
			localStorage.setItem('inno_lang', this.currentLang);
			window.dispatchEvent(new CustomEvent('inno_lang_change', { detail: this.currentLang }));
			await this.loadI18n();
			// 重新生成月度报告以更新报告名称的本地化
			this.generateMonthlyReports();
		},

		// Initialize data
		async initData() {
			try {
				await this.loadMonthlyReports();
			} catch (error) {
				console.error('Failed to load data:', error);
			} finally {
				this.loading = false;
				// 确保页面显示在顶部
				this.$nextTick(() => {
					window.scrollTo(0, 0);
				});
			}
		},

		// Load monthly reports
		async loadMonthlyReports() {
			this.generateMonthlyReports();
		},

		// Generate monthly reports based on current language
		generateMonthlyReports() {
			this.monthlyReports = [];

			// Use all available report data from original file (2025, 2024, 2023)
			const availableReports = [
				// 2025年报告
				{ year: 2025, month: 10, key: '2025-10' },
				{ year: 2025, month: 9, key: '2025-09' },
				{ year: 2025, month: 8, key: '2025-08' },
				{ year: 2025, month: 7, key: '2025-07' },
				{ year: 2025, month: 6, key: '2025-06' },
				{ year: 2025, month: 5, key: '2025-05' },
				{ year: 2025, month: 4, key: '2025-04' },
				{ year: 2025, month: 3, key: '2025-03' },
				{ year: 2025, month: 2, key: '2025-02' },
				{ year: 2025, month: 1, key: '2025-01' },
				// 2024年报告
				{ year: 2024, month: 12, key: '2024-12' },
				{ year: 2024, month: 11, key: '2024-11' },
				{ year: 2024, month: 10, key: '2024-10' },
				{ year: 2024, month: 9, key: '2024-09' },
				{ year: 2024, month: 8, key: '2024-08' },
				{ year: 2024, month: 7, key: '2024-07' },
				{ year: 2024, month: 6, key: '2024-06' },
				{ year: 2024, month: 5, key: '2024-05' },
				{ year: 2024, month: 4, key: '2024-04' },
				{ year: 2024, month: 3, key: '2024-03' },
				{ year: 2024, month: 2, key: '2024-02' },
				{ year: 2024, month: 1, key: '2024-01' },
				// 2023年报告
				{ year: 2023, month: 12, key: '2023-12' },
				{ year: 2023, month: 11, key: '2023-11' },
				{ year: 2023, month: 10, key: '2023-10' },
				{ year: 2023, month: 9, key: '2023-09' },
				{ year: 2023, month: 8, key: '2023-08' },
				{ year: 2023, month: 7, key: '2023-07' },
				{ year: 2023, month: 6, key: '2023-06' },
				{ year: 2023, month: 5, key: '2023-05' },
				{ year: 2023, month: 4, key: '2023-04' },
				{ year: 2023, month: 3, key: '2023-03' },
				{ year: 2023, month: 2, key: '2023-02' },
				{ year: 2023, month: 1, key: '2023-01' }
			];

			// Generate reports from available data
			availableReports.forEach(report => {
				const reportKey = `new-report-name-${report.key}`;
				const reportName = this.t(reportKey);

				if (reportName !== reportKey) { // Only add if translation exists
					// Localized date format
					const localizedDate = this.currentLang === 'zh'
						? `${report.year}年${report.month}月`
						: `${report.year} ${this.getMonthName(report.month)}`;

					this.monthlyReports.push({
						id: report.key,
						date: localizedDate,
						name: reportName,
						year: report.year,
						month: report.month
					});
				}
			});
		},

		// Load more reports
		loadMoreReports() {
			this.displayCount += 10; // 每次加载10条更多
		},

		// Get localized month name
		getMonthName(month) {
			const monthNames = {
				zh: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],
				en: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']
			};
			return monthNames[this.currentLang][month - 1] || month;
		},

		// Open report page
		openReport(report) {
			// Open the corresponding report HTML page in report directory
			// For English reports, add -en suffix (matching original file pattern)
			const reportSuffix = this.currentLang === 'en' ? '-en' : '';
			const reportUrl = `/new/report/${report.id}${reportSuffix}.html`;
				window.open(reportUrl, '_blank');
		},

		// Generate annual report
		generateAnnualReport() {
		},

		// View sample report
		viewSampleReport() {
		},

		// View sample by type
		viewSample(type) {
		},

		// Load user information
		async loadUserInfo() {
			try {
				// Get userId first
				const userId = localStorage.getItem('userId');
				if (!userId) {
					console.log('[Report] No userId found');
					this.currentUserPlan = this.t('freePlan');
					return;
				}

				// Try to get user info from UserProfile sessionStorage cache
				const cacheKey = `user_profile_data_${userId}`;
				const cachedData = sessionStorage.getItem(cacheKey);

				if (cachedData) {
					console.log('[Report] Using cached user data from sessionStorage');
					this.userInfo = JSON.parse(cachedData);
					console.log('[Report] User info from cache:', this.userInfo);

					// Get user membership/role - check multiple possible field names
					const membership = this.userInfo.Group || this.userInfo.group ||
					                   this.userInfo.Role || this.userInfo.role ||
					                   this.userInfo.Membership || this.userInfo.membership || '';

					console.log('[Report] User membership:', membership);
					this.currentUserPlan = this.getMembershipLabel(membership);
					console.log('[Report] Current user plan:', this.currentUserPlan);
					return;
				}

				console.log('[Report] No cached data, fetching from API');

				// Get API token from cookie
				const apiToken = this.getCookie('api_token');
				if (!apiToken) {
					console.log('[Report] No API token found');
					this.currentUserPlan = this.t('freePlan');
					return;
				}

				// Fetch user info from API using WebService
				const response = await axios.get('/User_Info.asmx/GetUserInfo', {
					params: { user_id: userId },
					headers: {
						'Authorization': 'Bearer ' + apiToken
					}
				});

				console.log('[Report] User info response:', response.data);

				// Parse XML response
				if (response.data) {
					const parser = new DOMParser();
					const xmlDoc = parser.parseFromString(response.data, 'text/xml');
					const jsonStr = xmlDoc.getElementsByTagName('string')[0]?.textContent;

					if (jsonStr) {
						const userData = JSON.parse(jsonStr);
						this.userInfo = userData;
						console.log('[Report] User info parsed:', this.userInfo);

						// Cache the data for next time
						sessionStorage.setItem(cacheKey, JSON.stringify(userData));
						sessionStorage.setItem(`user_profile_cache_time_${userId}`, Date.now().toString());

						// Get user membership/role
						const membership = this.userInfo.Group || this.userInfo.group ||
						                   this.userInfo.Role || this.userInfo.role ||
						                   this.userInfo.Membership || this.userInfo.membership || '';

						console.log('[Report] User membership:', membership);
						this.currentUserPlan = this.getMembershipLabel(membership);
						console.log('[Report] Current user plan:', this.currentUserPlan);
					} else {
						console.log('[Report] No JSON data in XML response');
						this.currentUserPlan = this.t('freePlan');
					}
				} else {
					console.log('[Report] No user data in response');
					this.currentUserPlan = this.t('freePlan');
				}
			} catch (error) {
				console.error('[Report] Failed to load user info:', error);
				this.currentUserPlan = this.t('freePlan');
			}
		},

		// Get cookie value
		getCookie(name) {
			const value = `; ${document.cookie}`;
			const parts = value.split(`; ${name}=`);
			if (parts.length === 2) {
				return parts.pop().split(';').shift();
			}
			return null;
		},

		// Get membership label
		getMembershipLabel(membership) {
			if (!membership) {
				console.log('[Report] No membership value');
				return this.t('freePlan');
			}

			const membershipStr = String(membership);
			const membershipUpper = membershipStr.toUpperCase();

			console.log('[Report] Checking membership:', membershipStr, 'Upper:', membershipUpper);

			if (membershipUpper === 'ADMIN' || membershipUpper === 'ADMINISTRATOR') {
				console.log('[Report] User is ADMIN');
				return this.t('adminPlan');
			}
			if (membershipUpper.includes('PREMIUM') || membershipUpper.includes('PAID') || membershipUpper.includes('PRO')) {
				console.log('[Report] User is PREMIUM');
				return this.t('premiumPlan');
			}

			console.log('[Report] User is FREE');
			return this.t('freePlan');
		},

		// Check if user is admin
		isUserAdmin() {
			if (!this.userInfo) {
				console.log('[Report] No userInfo');
				return false;
			}

			// Check multiple possible field names
			const membership = this.userInfo.Group || this.userInfo.group ||
			                   this.userInfo.Role || this.userInfo.role ||
			                   this.userInfo.Membership || this.userInfo.membership || '';

			if (!membership) {
				console.log('[Report] No membership field found');
				return false;
			}

			const membershipUpper = String(membership).toUpperCase();
			const isAdmin = membershipUpper === 'ADMIN' || membershipUpper === 'ADMINISTRATOR';

			console.log('[Report] isUserAdmin check - membership:', membership, 'isAdmin:', isAdmin);
			return isAdmin;
		},

		// View China Investment Report (with permission check)
		viewChinaInvestReport() {
			console.log('[Report] Button clicked - viewChinaInvestReport');
			console.log('[Report] userInfo:', this.userInfo);
			console.log('[Report] currentUserPlan:', this.currentUserPlan);

			// Check if user is admin
			const isAdmin = this.isUserAdmin();
			console.log('[Report] isAdmin result:', isAdmin);

			if (isAdmin) {
				// Admin user - open report
				console.log('[Report] Opening report for admin user');
				window.open('china_investor_report.html', '_blank');
			} else {
				// Non-admin user - show upgrade modal
				console.log('[Report] Showing upgrade modal for non-admin user');
				this.showUpgradeModal = true;
			}
		},

		// Contact for upgrade
		contactForUpgrade() {
			this.showUpgradeModal = false;
			this.contactService();
		},

		// Contact service
		contactService() {
			// Scroll to contact section in sidebar
			const contactCard = document.querySelector('.qr-section');
			if (contactCard) {
				contactCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
				// Add highlight effect
				contactCard.parentElement.style.animation = 'pulse 1s ease-in-out 2';
			}
		},

		// View current report from modal
		viewCurrentReport() {
			if (this.selectedReport) {
				this.openReport(this.selectedReport);
			}
		}
	}
});

// Mount and expose for debugging
const appInstance = app.mount('#app');
window.reportApp = appInstance;
    </script>
</body>
</html>